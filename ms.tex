% \documentclass{emulateapj}
\documentclass[letterpaper,12pt,preprint]{aastex}

\input{../paper-helpers/preamble.tex}

% packages
\usepackage{amssymb,amsmath,amsbsy}
\usepackage{booktabs}
\usepackage[caption=false]{subfig}
\usepackage{multirow}

% TO DO
\usepackage{graphicx} 
\usepackage{color}
\newcommand{\todo}[1]{{\color{red} TODO: #1}}

\begin{document}

%\title{Tapping the keg: the Galactic bar peculiarity of the Ophiuchus stream and the Galactic bar}
\title{Spending too much time at the Galactic bar: did the Ophiuchus stream form on a chaotic orbit?}
\author{Adrian M. Price-Whelan\altaffilmark{\colum,\adrn},
            Branimir Sesar\altaffilmark{\mpia}, ...
%            Sarah Pearson\altaffilmark{\colum},
%            Kathryn V. Johnston\altaffilmark{\colum},
%            Hans-Walter Rix\altaffilmark{\mpia}
}

% Affiliations
\newcommand{\colum}{1}
\newcommand{\adrn}{2}
\newcommand{\mpia}{3}

\altaffiltext{\colum}{Department of Astronomy,
                      Columbia University,
                      550 W 120th St.,
                      New York, NY 10027, USA}
\altaffiltext{\adrn}{To whom correspondence should be addressed: adrn@astro.columbia.edu}
\altaffiltext{\mpia}{Max-Planck-Institut f\"ur Astronomie,
                     K\"onigstuhl 17, D-69117 Heidelberg, Germany}
                     
\begin{abstract}

% Context
The Ophiuchus stream was recently discovered as an over-density of main sequence stars in Pan-STARRS (PS1) photometry and was later detected in BHB stars using line-of-sight velocities: XX of the YY BHB stars around the sky position of the stream appear kinematically distinct from the background halo population.
A small number of stars (XX) near the ends of the stream have similarly distinct velocities but with much larger velocity and spatial dispersions compared to the short segment of the stream first identified in the PS1 data.
In recent work, we have shown that streams formed on chaotic orbits may display similar kinematic signatures---short segments of recently-disrupted stellar debris flanked by high-dispersion, low-density ``stream-fans'' at the ends of the stream.
The stream's proximity to the triaxial, time-dependent potential of the Galactic bar and the peculiar kinematics and morphology of the stream suggest that the stream may have formed on a chaotic orbit.
% Aims
Here we study whether the Galactic bar can lead to chaotic orbits near (in phase-space) to the Ophiuchus stream. 
% Methods
We construct a potential model for the Milky Way bar based on recent measurements of the density of XXX stars.
We then assess the level of chaos for orbits like that of the Ophiuchus stream and generate mock streams along these orbits that qualitatively reproduce the observed kinematics of the stream.
% Results
We find that the apparent shortness and nearby low-density, high-velocity-dispersion ...
% Conclusions
These results motivate efforts to obtain deep photometry of the region surrounding the Ophiuchus stream to detect the predicted low-surface-brightness fans of stellar debris.
The existence of or lack of stream fans may provide an interesting constraint on the triaxiality and pattern speed of the bar.

\end{abstract}

% \keywords{}

\section{Introduction}\label{sec:introduction}

The Ophiuchus stream \citep{bernard14, sesar15} is a recently discovered stellar tidal stream that sits above the Galactic bulge at a Galactocentric radius and height $(R,z) \approx (1, 4.3)~{\rm kpc}$. All observational evidence suggests that the stream is a totally disrupted globular cluster: The stream stars have (1) a small positional dispersion orthogonal to the extended direction of the stream ($\approx$10 pc); (2) a small velocity dispersion $\approx$0.4 ${\rm km}~{\rm s}^{-1}$; (3) an old stellar population ($\approx$12 Gyr) estimated from isochrone fitting; and (4) no detectable over-density along the stream that could be  the progenitor system \citep[][hereafter S15a]{sesar15}. 

The deprojected length of the visible part of the stream ($\approx$1.5 kpc) is short for the age of its stellar population. S15a fit an orbit to the kinematics of the stream stars in a static, axisymmetric model for the gravitational field of the inner Galaxy and ran N-body simulations of globular clusters on this orbit. S15a find that---on this orbit---the observed portion of the stream must have been formed in the last $\lesssim$400 Myr for the stream to remain as short as it is observed. This dynamical age is at odds with the old stellar population. More recently, a significant observational effort has followed-up nearly all BHB star candidates within XX deg of the stream to obtain radial velocities to identify more stream members \citep{sesar15b}. The stream has a very distinct and large line-of-sight velocity ($\approx$290 \kms) and is therefore easily detected above the background halo population. Of the \todo{XX} stars followed up, six have velocities significantly discrepant with the halo population. Of these six stars, two lie within the previously detected extent of the stream and have velocities consistent with the previously identified stream members. The remaining four stars lie close to an extrapolation of the stream, have velocities much larger than halo stars in this region ($v_{\rm los}>230$ \kms), but have a velocity dispersion $\approx$75 times the measured internal velocity dispersion of the stream stars and positional spread much larger than the orthogonal positional dispersion of the main part of the stream. These low-density, high-dispersion features were not modeled in S15a and N-body simulations on the orbit fit from the previous work do not  reproduce these features.

It is not surprising that the orbit fit in the static, axisymmetric potential model used in S15a leads to a dynamical puzzle and failed to predict the new features: it is now well-known that the Galactic bulge contains a triaxial, bar-like structure several kpc in size \citep[e.g.,][]{blitzXX, wegg13, MANY}. Given the proximity of the stream to the center of the Galaxy, the time-dependent, triaxial potential of the Galactic bar must be taken into account when modeling the orbit of the progenitor system. The presence of a bar-like perturbation to the potential will change the possible orbit of the stream progenitor and will drastically change the resonance structure of orbits in the inner galaxy \citep{athanassoula, portail15b MANY}, potentially introducing a significant number of chaotic orbits in this region \citep{weinberg15}.

Recent work has shown that chaos can dramatically alter the density evolution of tidal streams. Along certain chaotic orbits, the stream stars will spread much faster in 3D position than from ordinary phase-mixing and, depending on the orbital phase at which the stream is observed, may develop large, low-density ``fans'' of stars at the ends of a stream \citep{apw15-chaos}. In this work, we study whether stream-fanning---chaotic or simply from density evolution in a triaxial, time-dependent potential---can explain the observed properties of the Ophiuchus stream. 

In Section~\ref{sec:method} we describe the methods used in this work: in Section~\ref{sec:potential} we describe the models we use for the gravitational potential of the Galaxy, in Section~\ref{sec:mocks} we explain the simple method we use to generate mock streams, and in Section~\ref{sec:chaos-indicator} we briefly describe the methods we use for detecting and characterizing chaotic orbits. In Section~\ref{sec:results1} we discuss the differences in the orbit structure between a static, axisymmetric potential model and a model with a time-dependent bar potential, and in Section~\ref{sec:results2} we use mock streams to argue that [chaotic stream-fanning is a plausible explanation for the observational peculiarities of the Ophiuchus stream.] We conclude in Section~\ref{sec:conclusions}.

\section{Methods}\label{sec:method}

Our goal is to (1) assess whether the Galactic bar can produce significant numbers of chaotic orbits in the inner Galaxy in the vicinity of the Ophiuchus stream and (2) if chaotic density evolution of tidal debris stripped from the progenitor of this stream can explain the apparent shortness of the stream and low-density, high-dispersion ends. In this section, we describe the potential models we use to represent the galaxy and describe the methods we use to detect and quantify the strength of chaos for orbits. We then describe a simplified version of the \streakline\ method that we use to generate mock stellar streams \citep{kuepper12}. 

\subsection{Potential models}\label{sec:potential}

To integrate orbits and to compute chaos indicators we must choose a gravitational potential model to represent the potential of the Milky Way. The key feature of the potential that we would like to capture is the time-dependence and triaxiality of the Galactic bar. Recent work has used stellar number counts of \todo{XX} stars in the Galactic bulge to constrain dynamical models of the bar \citep{portail15}. Measurements of the total mass of the bar feature from this study are largely consistent with past work \citep[e.g.,][]{XX}, however the measured pattern speed and present bar angle are significantly discrepant and this difference is not fully understood. We construct a parametrized potential model consisting of a triaxial, time-dependent (rotating) bulge component added to simple models for the disk and halo of the Milky Way. We describe below how we fix the parameters of the disk, halo, and bar or bulge component, but explore different choices for the time-dependence and orientation of the bar. We also define a static potential with a spherical bulge for comparison. These potential models are meant to be representative rather than definitive since the potential of the inner and outer Milky Way are not well known. 

\subsubsection{Barred potential}
We use a flattened Navarro-Frenk-White potential to represent the dark matter halo \citep[e.g.,][]{kuepper15} parametrized as
\begin{align}
	\Phi(r) &= -v_h^2\,\frac{\ln{(1 + r/r_s)}}{r/r_s}\label{eq:flatnfw}\\
	r^2 &= x^2 + y^2 + \frac{z^2}{q_z^2}
\end{align}
and a Miyamoto-Nagai potential for the disk \citep{miyamoto75}. For the bar component, we use a basis function expansion (BFE) of the potential and density of the bar with expansion coefficients derived for a triaxial, exponential bar density \citep[][hereafter W12]{wang12}. We use the pre-computed expansion coefficients used in W12, which were computed from a low-order expansion of the triaxial bar density used in \citet{dwek95}.\footnote{The coefficients presented in W12 are for just the cosine terms (the $A_{lm}$ in \citet{hernquist92} or the $S_{nlm}$ in \citet{lowing11}) because all sine terms have zero coefficients for a triaxial density function.} We have implemented the BFE computation of the potential, density, and gradient of the potential in \texttt{C} and \python\ and the code is publicly available on \github.\footnote{\url{https://github.com/adrn/biff}} 

The BFE representation fixes the axis ratios of the bar---that is, the the exponential scale lengths along the three axes of the bar were adopted from \cite{dwek95} when the expansion coefficients were calculated in W12); all other potential parameter values are given in Table~\ref{tbl:potential-params-barred}. The mass of the halo is fixed and the mass of the disk and bar are varied in order to qualitatively reproduce the flatness and amplitude of the circular velocity curve of the Milky Way \citep{bovy12}. Figure~\ref{fig:circ-vel-barred} shows the circular velocity along the line connecting the Sun to the Galactic center in this model (the Galactic $x$ axis). Figure~\ref{fig:surface-density-barred} shows contours of constant surface density for a face-on (left) and edge-on (right) view of this potential model with the bar angle set to $20^\circ$ \citep[compare to, e.g., Figure 3 in][]{portail15}. 

\begin{table*}[ht]
\begin{center}
	\begin{tabular}{ c | c | c }
	         \toprule
	         Component & Parameter & Value \\\toprule
		Disk & $M_{\rm disk}$ & $5 \times 10^{10}~\msun$ \\
		& $a$ & 3~{\rm kpc}\\
		& $b$ & 0.28~{\rm kpc} \\\midrule
	         Halo & $v_c$ & 185.8~\kms\\
		& $r_s$ & 30~kpc \\
		& $q_z$ & 0.9 \\\midrule
		Bar & $M_{\rm bar}$ & $1.8 \times 10^{10}~\msun$ \\
		& $\alpha$ & $20^\circ$\\
		& $\Omega$ & $60~{\rm km}~{\rm s}^{-1}~{\rm kpc}^{-1}$ \\
		\bottomrule
		\end{tabular}
	\caption{The disk potential scale lengths ($a$, $b$) were adopted following \citep{bovy15-galpy} to match the exponential scale length of the disk \citep{bovyrix13} and local dark-matter density \citep[e.g.,][]{bovytremaine12}. The bar mass is taken from recent 3D density modeling of red clump stars in the Galactic bulge \citep{portail15}. The bar angle, $\alpha$, and pattern speed, $\Omega$, are taken taken from \cite{dwek95} and \cite{wang12}, respectively. Halo flattening is taken from recent work that suggests the inner Milky Way halo is slightly oblate \citep{koposov10, kuepper15}. The halo mass scale is set by specifying the circular velocity at the scale radius, $v_c$, and the scale velocity in Equation~\ref{eq:flatnfw} is given by $v_h^2 = v_c^2 / (\ln2 - 1/2)$. \label{tbl:potential-params-barred}}
\end{center}
\end{table*}

\subsubsection{Static potential}

For comparison, we also define a time-independent potential model with a purely spherical bulge. In this model, we set the bar mass to 0 and instead add a spheroidal component represented with a Hernquist potential \citep{hernquist90}. Parameters for this potential model are given in Table~\ref{tbl:potential-params-static}. Figure~\ref{fig:circ-vel-barred} shows the circular velocity along the line connecting the Sun to the Galactic center in this model (the Galactic $x$ axis). Figure~\ref{fig:surface-density-static} shows contours of constant surface density for a face-on (left) and edge-on (right) view of this potential model.

\begin{table*}[ht]
\begin{center}
	\begin{tabular}{ c | c | c }
	         \toprule
	         Component & Parameter & Value \\\toprule
		Disk & $M_{\rm disk}$ & $6.5 \times 10^{10}~\msun$ \\
		& $a$ & 3~{\rm kpc}\\
		& $b$ & 0.28~{\rm kpc} \\\midrule
	         Halo & $v_c$ & 185.8~\kms\\
		& $r_s$ & 30~kpc \\
		& $q_z$ & 0.9 \\\midrule
		Spheroid & $M_{\rm sph}$ & $10^{10}~\msun$ \\
		& $c$ & 0.2 \\
		\bottomrule
		\end{tabular}
	\caption{Same as Table~\ref{tbl:potential-params-barred}, except: the disk mass is increased to account for removing the bar component, a spheroidal bulge component is added. \label{tbl:potential-params-static}}
\end{center}
\end{table*}

\subsection{Orbit grid initial conditions}\label{sec:orbit-grids}

We wish to classify and analyze orbits around the orbit of the progenitor of the Ophiuchus stream, however the progenitor has not been found. We therefore take the medan position and velocity of stream members  from previous work and sample from the error distribution to generate initial conditions (these values are given in Table 3 of S15). We assume the mean Galactic longitude and latitude are fixed but generate samples in distance modulus, proper motions, and line-of-sight velocity assuming all uncertainties are Gaussian and independent. For each sample, we compute the proper motion angle (on the sky, in Galactic coordinates) and reject any sample with an angle relative to the elongation of the stream $>15^\circ$. We convert all sampled heliocentric coordinates to Galactocentric, cartesian coordinates by fixing the Sun to $(x,y,z) = (-8,0,0)~{\rm kpc}$ with $(v_x,v_y,v_z) = (-11.1, 220+24, 7.25)~{\rm km}~{\rm s}^{-1}$ \citep{schonrich10, bovy12}. 

\subsection{Detecting and characterizing chaos with frequency diffusion}\label{sec:chaos-indicator}

Regular orbits are quasi-periodic: any phase-space component of the orbit can be decomposed in terms of a Fourier series, e.g.,
\begin{equation}
	x(t) = \sum^\infty_k \, a_{x,k}\, e^{i\, \omega_k \, t}.
\end{equation}
The amplitudes, $\bs{a}_k$ are constants which determine the strength of each mode, and the frequencies in each Fourier mode, $\omega_k$, are linear, integer combinations of the fundamental frequencies of the orbit, $\bs{\Omega}$---that is,
\begin{equation}
	\omega_k = \bs{n}_k \cdot \bs{\Omega}
\end{equation}
where $\bs{n}_k$ is a integer vector with dimensionality equal to the number of degrees of freedom of the gravitational potential \citep[e.g.,][]{binney82, binneytremaine}. The fundamental frequencies of a regular orbit are directly related to the orbital actions, a set of integrals of motion intricately related to the [...] of Hamiltonian and nonlinear dynamics \citep[e.g.,][]{??}. The fundamental frequencies can be approximated for numerically-integrated orbital time series by measuring the positions and amplitudes of spectral lines in the Fourier transform of the orbital components. A very accurate procedure for numerically computing the frequencies was developed by \citet{laskar93} and has been re-implemented in \python\ and released as open-source software \citep[\superfreq;][]{superfreq}. 

Chaotic orbits have no actions and therefore no fundamental frequencies. The frequencies and actions drift erratically in time with rates that depend on the structure of resonances surrounding such orbits. The evolution of the frequencies changes the configuration-space appearance of finite sub-sections of chaotic orbits and greatly enhances the density evolution of ensembles of nearby chaotic orbits; this has a dramatic effect on the morphological evolution of tidal streams \citep[e.g.,][]{apw15-chaos}. Numerically-integrated trajectories can be identified as chaotic orbits by the detection of frequency diffusion \citep[e.g.,][]{laskar96, valluri98}. 

The accuracy of the frequency-finding method (\superfreq) allows for detecting very small changes in the frequencies of even mildly chaotic orbits. Measuring the rate of frequency diffusion is therefore a powerful tool for detecting and characterizing dynamical chaos \citep[e.g.,][]{many}. From measuring the frequencies in many consecutive, overlapping time-windows along a numerically integrated orbit, we define the frequency diffusion rate, $DERP$, as
\begin{equation}
	yo
\end{equation}
where the index $k$ refers to the window number and $\tau$ is the shift in time between two consecutive windows. We note that this definition differs from previous, coarse approximations of the diffusion rate that simply differenced the frequencies computed in two consecutive time windows. We use this frequency diffusion rate to identify chaotic orbits integrated in the potential models described above.

\subsection{Generating mock streams}\label{sec:mocks}

To generate mock stellar streams, we use a method similar to \streakline\ \citep{kuepper12}. For a given set of ``final conditions''---here, a position and velocity sampled from the observational error distribution for the Ophiuchus stream; Section~\ref{sec:orbit-grids}---we integrate the orbit backwards in time for a given integration period, $T$, in the specified potential. To generate a mock stream, we must set a progenitor mass, $m$, \todo{and mass-loss rate, $\dot{m}$} which sets the tidal radius of the mock disrupting globular cluster. From the endpoint of the backwards-integration (e.g., the initial conditions), we begin integrating the orbit forward in time, but now at each time-step a test-particle is released at each Lagrange point of the parent, progenitor orbit. The position of the test-particle is sampled from an isotropic Gaussian centered on each of the Lagrange points and the velocity of the particle is set equal to the velocity of the progenitor with a small Gaussian scatter in the radial direction. \todo{why these choices?} This method has been shown to reproduce the morphologies of N-body simulations of globular cluster streams, but requires far less computing time because it relies only on integrating test-particle orbits.

\section{Results}

Using the orbit initial conditions described above (Section~\ref{sec:orbit-grids}), we integrate orbits and compute the frequency diffusion rate for the static potential and for XX barred models with varied initial bar angle and pattern speed. We find that [...] 

\subsection{Reproducing the observed properties of the stream}\label{sec:results2}

\section{Conclusions}\label{sec:conclusions}

We have found that a qualitative but observationally-motivated potential model for the Galactic bar generates a significant number of chaotic orbits in the vicinity of the recently-discovered Ophiuchus stream. By sampling many possible phase-space 6D positions and velocities for the stream centroid from the observational error distribution, we have shown that most possible orbits are strongly chaotic in the time-dependent, barred potential model for the Milky Way, but are mostly regular, eccentric orbits in a static, axisymmetric potential. We have shown that---using \streakline\ models of the stream density---the apparent shortness of the stream and the existence of nearby, high-dispersion stars can be explained by chaotic density evolution of the stripped stars. This is the first time chaos has been used to explain the morphology and [...] of a stellar stream. This work demonstrates the importance of the Galactic bar on the potential of the inner Milky Way and has important implications for future modeling of streams near in this region. This result also motivates deep imaging around the Ophiuchus stream to measure the density contrast of the ``fanned'' debris compared to the main stream and to find more candidate stars associated with chaotic tidal debris.

\acknowledgements
APW is supported by a National Science Foundation Graduate Research Fellowship under Grant No.\ 11-44155.
APW acknowledges the staff at the MPIA for...
The authors wish to acknowledge Victor Debattista, ...
This research made use of Astropy, a community-developed core Python package for Astronomy \citep{astropy13}.
This work additionally relied on Columbia University's \emph{Yeti} compute cluster, and we acknowledge the Columbia HPC support staff for assistance. \\

\bibliographystyle{apj}
\bibliography{refs}

% ---------------------------------------------------------------------------------
\clearpage
\begin{figure}[p]
\begin{center}
\includegraphics[width=\textwidth]{figures/barred-circ-vel}
\caption{Circular velocity curve along the Sun-Galactic center line for the barred MW potential model. Solid black line shows total (sum of all components), lines below show a decomposition by potential component. Vertical grey bar shows approximate position of the Sun, horizontal grey bar shows roughly the range in measured circular velocity of the Sun.}
\label{fig:circ-vel-barred}
\end{center}
\end{figure}

% ---------------------------------------------------------------------------------
\clearpage
\begin{figure}[p]
\begin{center}
\includegraphics[width=\textwidth]{figures/barred-surface-density-contour}
\caption{Contours of constant surface density for two projections of the barred MW potential model. For both face-on view (left panel) and edge-on view (right panel), four contours are drawn per decade in surface density between $10^7$ and $10^{12}~\msun~{\rm kpc}^{-3}$. Note the perturbation from the bar potential within Galactocentric radius $r \lesssim 4~{\rm kpc}$. The Sun's position is indicated by the `$\odot$' symbol.}
\label{fig:surface-density-barred}
\end{center}
\end{figure}

% ---------------------------------------------------------------------------------
\clearpage
\begin{figure}[p]
\begin{center}
\includegraphics[width=\textwidth]{figures/static-circ-vel}
\caption{Same as Figure~\ref{fig:circ-vel-barred} for the static, axisymmetric MW potential model. }
\label{fig:circ-vel-static}
\end{center}
\end{figure}

% ---------------------------------------------------------------------------------
\clearpage
\begin{figure}[p]
\begin{center}
\includegraphics[width=\textwidth]{figures/static-surface-density-contour}
\caption{Same as Figure~\ref{fig:surface-density-barred} for the static, axisymmetric MW potential model. }
\label{fig:surface-density-static}
\end{center}
\end{figure}

\end{document}